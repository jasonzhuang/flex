<?xml version="1.0" encoding="utf-8"?>
<mx:Application
	xmlns:mx="http://www.adobe.com/2006/mxml"
	initialize="init()"
	layout="vertical">
	<mx:Script>
		<![CDATA[
			/**
			 * 1.draw(): draw source on the bitmap, and scale the source(not scale bitmap) if matrix exist,
			 * and the matrix can both scale source's width and height in proportion
			 * 2.when set both width and height in Image, the Image actually size is based on either width or height,
			 * not set both value
			 */
			import mx.core.UIComponent;
			
			private var container:UIComponent;
			private var bitmap:Bitmap;
			private var bitmapData:BitmapData;
			
			/**
			 * the original size is 400*300
			 */
			private var imgUrl:String = "assets/Banana.jpg";
			
			private function init():void {
				container = new UIComponent();
				//if set the third value to true, can't see the bitmap
				bitmapData = new BitmapData(300,300, false, 0x0000ff);
				bitmap = new Bitmap(bitmapData);
				container.addChild(bitmap);
				this.addChild(container);
			}
			
			private function draw():void {
				trace("before: " + bitmapData.width);
				var matrix:Matrix = new Matrix(1.5, 0, 0, 1.5);
				var bitmapData2:BitmapData = new BitmapData(100, 100, false, 0xff0000);
				bitmapData.draw(bitmapData2, matrix);
//				bitmapData.draw(bitmapData2, new Matrix());
//				bitmap = new Bitmap(bitmapData);
				var bitmap:Bitmap = new Bitmap(bitmapData);
				createAnother(bitmap);
				trace("after: " + bitmapData.width);
			}
			
			private function createAnother(bitmap:Bitmap):void {
				var another:UIComponent = new UIComponent();
				another.addChild(bitmap);
				this.addChild(another);
				another.x = 50;
				another.y = 50;
			}
			
			private function drawPic():void {
				var matrix:Matrix = new Matrix(0.5, 0, 0, 0.5);
				bitmapData.draw(img, matrix);
			}
		]]>
	</mx:Script>
	<mx:HBox width="500" height="500" backgroundColor="#ff0000">
		<mx:Image id="img" width="400" height="200" source="{imgUrl}"/>
	</mx:HBox>
	<mx:Button label="draw" click="drawPic()"/>
</mx:Application>
